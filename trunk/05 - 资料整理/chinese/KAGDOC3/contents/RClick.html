<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html  xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh" lang="zh">
<!-- generated by to_html.pl from RClick.xml -->
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<title>关于右键菜单的制作</title>
	<meta name="author" content="W.Dee" />
	<meta http-equiv="Content-Style-Type" content="text/css" />
	<meta http-equiv="Content-Script-Type" content="text/javascript" />
	<link href="browser.css" type="text/css" rel="stylesheet" title="åéåéç¸å³æ ååèæ ·å¼" />
	<link href="mailto:dee@kikyou.info" rev="Made" />
	<link href="index.html" target="_top" rel="Start" title="é¦é¡µ" />
</head>
<body>
<h1><a id="id178" name="id178">右键菜单是指</a>
</h1><div class="para"><div>
　点下鼠标右键后呼叫的 KAG 的游戏界面。<br />
　例如使用右键来调出存储/读取画面。<br />
</div></div>
<h1><a id="id179" name="id179">总之先上范例</a>
</h1><div class="para"><div>
　调用右键菜单的指令是 rclick 。使用这个指令、可以设定点下右键后呼叫的剧本段落。此外，也可以不使用呼叫（调用菜单后，使用return可以返回游戏），而是直接跳转到某个标签（右键跳跃后无法返回，等同于jump）。<br />
<br />
　例如，在 rlick.ks 里写入以下内容。<br />

<br />
<code class="bq"><span class="weak">例:</span><br />*rclick<br />
@rclick&nbsp;jump=true&nbsp;storage=&quot;rclick.ks&quot;&nbsp;target=&quot;*exit&quot;&nbsp;enabled=true<br />
@current&nbsp;layer=message1<br />
@layopt&nbsp;layer=message0&nbsp;page=fore&nbsp;visible=false<br />
@layopt&nbsp;layer=message1&nbsp;page=fore&nbsp;visible=true<br />
@er<br />
这里是右键菜单。<br />
[s]<br />
<br />
*exit<br />
@layopt&nbsp;layer=message1&nbsp;page=fore&nbsp;visible=false<br />
@layopt&nbsp;layer=message0&nbsp;page=fore&nbsp;visible=true<br />
@current&nbsp;layer=message0<br />
@rclick&nbsp;call=true&nbsp;storage=&quot;rclick.ks&quot;&nbsp;target=&quot;*rclick&quot;&nbsp;enabled=true<br />
@return<br />
</code>
<br />

　接下来，例如说，我们在 first.ks 里写入以下内容。
<br />
<code class="bq">@rclick&nbsp;call=true&nbsp;storage=&quot;rclick.ks&quot;&nbsp;target=&quot;*rclick&quot;&nbsp;enabled=true<br />
</code>
<br />

<br />
　这样的话、点下鼠标右键后就会呼叫 rclick.ks 的 *rclick 标签。<br />
　如上的例子，在 rclick.ks 内、首先进行了一次右键操作的更改，将右键操作设定为“跳转到 *exit” 。这样的话、调出右键菜单后，再点一次右键，就会返回游戏中了。<br />
　在菜单调用的时候隐藏显示一般游戏对话的 文字层 0 。这样的话、 文字层 0 上即使有选择支等等也暂时无法操作。<br />
　同时显示文字层 1 、在文字层 1 上显示「这里是右键菜单。」，并用 [s] 等待玩家操作。<br />
</div></div>
<h1><a id="id180" name="id180">比较难的例子</a>
</h1><div class="para"><div>
　以下是一个比较复杂的右键菜单范例，可以在右键菜单内进行查看历史记录，存储，读取等操作。
<br />
<code class="bq"><span class="weak">例:</span><br />*sub1<br />
@tempsave<br />
;&nbsp;↑临时保存游戏状态<br />
@history&nbsp;output=false<br />
;&nbsp;↑右键菜单内的文字不会输出在历史记录内<br />
@mapdisable&nbsp;layer=0&nbsp;page=fore<br />
;&nbsp;↑假如当前显示着地图的话，就用这种方式使地图操作无效（和隐藏文字层是一样的，为了防止误操作）<br />
@backlay<br />
@layopt&nbsp;layer=message1&nbsp;page=back&nbsp;visible=true<br />
;&nbsp;↑右键菜单将使用&nbsp;文字层&nbsp;1&nbsp;来显示文字<br />
@layopt&nbsp;layer=message0&nbsp;page=back&nbsp;visible=false<br />
@current&nbsp;layer=message1&nbsp;page=back<br />
@position&nbsp;left=0&nbsp;top=0&nbsp;width=640&nbsp;height=480<br />
@eval&nbsp;exp=&quot;f.r_first=true&quot;<br />
;&nbsp;↑从游戏打开右键主菜单时，使用&nbsp;trans&nbsp;效果的标记（从下一级菜单，如存储菜单返回主菜单则不使用&nbsp;trans&nbsp;效果显示）。<br />
;<br />
*menu<br />
@er<br />
@nowait<br />
[link&nbsp;target=*hide]隐藏文字层[endlink][r]<br />
[link&nbsp;target=*history]查看历史记录[endlink][r]<br />
[link&nbsp;target=*load]读取游戏[endlink][r]<br />
[link&nbsp;target=*save]存储游戏[endlink][r]<br />
[link&nbsp;target=*gotostart]返回标题[endlink][r]<br />
[link&nbsp;target=*ret]回到游戏[endlink][r]<br />
@endnowait<br />
@current&nbsp;layer=message1&nbsp;page=fore<br />
@if&nbsp;exp=&quot;f.r_first&quot;<br />
@trans&nbsp;time=500&nbsp;rule=trans1&nbsp;vague=128<br />
@wt<br />
@endif<br />
@eval&nbsp;exp=&quot;f.r_first=false&quot;<br />
@s<br />
<br />
*ret<br />
;&nbsp;从右键菜单返回游戏<br />
@tempload&nbsp;bgm=false&nbsp;se=false&nbsp;backlay=true<br />
;使用tempload的话，右键菜单里所有更改的状态都会复原
;例如历史记录会恢复输出，文字层恢复显示等
@trans&nbsp;time=500&nbsp;rule=trans1&nbsp;vague=128<br />
@wt<br />
@return<br />
<br />
*hide<br />
;&nbsp;隐藏文字层<br />
@hidemessage<br />
@jump&nbsp;target=*menu<br />
<br />
*history<br />
;&nbsp;显示历史记录<br />
@showhistory<br />
@jump&nbsp;target=*menu<br />
<br />
*load<br />
;&nbsp;读取游戏<br />
;&nbsp;emb&nbsp;exp=&nbsp;....&nbsp;这部分请参考&nbsp;<a target="main" class="jump" href="TJSTips.html">TJS进阶使用预备知识</a>&nbsp;的说明<br />
@er<br />
@nowait<br />
[link&nbsp;target=*lt0][emb&nbsp;exp=&quot;kag.getBookMarkPageName(0)&quot;][endlink][r]<br />
[link&nbsp;target=*lt1][emb&nbsp;exp=&quot;kag.getBookMarkPageName(1)&quot;][endlink][r]<br />
[link&nbsp;target=*lt2][emb&nbsp;exp=&quot;kag.getBookMarkPageName(2)&quot;][endlink][r]<br />
[link&nbsp;target=*lt3][emb&nbsp;exp=&quot;kag.getBookMarkPageName(3)&quot;][endlink][r]<br />
[link&nbsp;target=*lt4][emb&nbsp;exp=&quot;kag.getBookMarkPageName(4)&quot;][endlink][r]<br />
[link&nbsp;target=*menu]返回[endlink][r]<br />
@endnowait<br />
@s<br />
<br />
*lt0<br />
@load&nbsp;place=0&nbsp;ask=true<br />
@jump&nbsp;target=*menu<br />
*lt1<br />
@load&nbsp;place=1&nbsp;ask=true<br />
@jump&nbsp;target=*menu<br />
*lt2<br />
@load&nbsp;place=2&nbsp;ask=true<br />
@jump&nbsp;target=*menu<br />
*lt3<br />
@load&nbsp;place=3&nbsp;ask=true<br />
@jump&nbsp;target=*menu<br />
*lt4<br />
@load&nbsp;place=4&nbsp;ask=true<br />
@jump&nbsp;target=*menu<br />
<br />
*save<br />
;&nbsp;存储游戏<br />
;&nbsp;emb&nbsp;exp=&nbsp;....&nbsp;这部分请参考&nbsp;<a target="main" class="jump" href="TJSTips.html">TJS进阶使用预备知识</a>&nbsp;的说明<br />
@er<br />
@nowait<br />
[link&nbsp;target=*st0][emb&nbsp;exp=&quot;kag.getBookMarkPageName(0)&quot;][endlink][r]<br />
[link&nbsp;target=*st1][emb&nbsp;exp=&quot;kag.getBookMarkPageName(1)&quot;][endlink][r]<br />
[link&nbsp;target=*st2][emb&nbsp;exp=&quot;kag.getBookMarkPageName(2)&quot;][endlink][r]<br />
[link&nbsp;target=*st3][emb&nbsp;exp=&quot;kag.getBookMarkPageName(3)&quot;][endlink][r]<br />
[link&nbsp;target=*st4][emb&nbsp;exp=&quot;kag.getBookMarkPageName(4)&quot;][endlink][r]<br />
[link&nbsp;target=*menu]返回[endlink][r]<br />
@endnowait<br />
@s<br />
<br />
*st0<br />
@save&nbsp;place=0&nbsp;ask=true<br />
@jump&nbsp;target=*menu<br />
*st1<br />
@save&nbsp;place=1&nbsp;ask=true<br />
@jump&nbsp;target=*menu<br />
*st2<br />
@save&nbsp;place=2&nbsp;ask=true<br />
@jump&nbsp;target=*menu<br />
*st3<br />
@save&nbsp;place=3&nbsp;ask=true<br />
@jump&nbsp;target=*menu<br />
*st4<br />
@save&nbsp;place=4&nbsp;ask=true<br />
@jump&nbsp;target=*menu<br />
<br />
<br />
*gotostart<br />
;&nbsp;「返回标题画面」<br />
@gotostart&nbsp;ask=true<br />
@jump&nbsp;target=*menu<br />
</code>
<br />

<br />
　此外，关于在存档时保存缩略图的情况，有一些需要注意的要点，请参考 locksnapshot 和 unlocksnapshot 的指令说明。<br />
</div></div>
	<script type="text/javascript" charset="UTF-8" src="documentid.js" ></script>
	<script type="text/javascript" charset="UTF-8" src="postcontent.js" ></script>
</body>
</html>
