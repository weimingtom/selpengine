<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html  xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh" lang="zh">
<!-- generated by to_html.pl from Macro.xml -->
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<title>宏(Macro)的使用</title>
	<meta name="author" content="W.Dee" />
	<meta http-equiv="Content-Style-Type" content="text/css" />
	<meta http-equiv="Content-Script-Type" content="text/javascript" />
	<link href="browser.css" type="text/css" rel="stylesheet" title="åéåéç¸å³æ ååèæ ·å¼" />
	<link href="mailto:dee@kikyou.info" rev="Made" />
	<link href="index.html" target="_top" rel="Start" title="é¦é¡µ" />
</head>
<body>
<h1><a id="id116" name="id116">所谓宏(Macro)就是</a>
</h1><div class="para"><div>
　宏就是，为了「将复数的指令，文字等，用一个指令表示」的缩写简化功能。<br />
<br />
　将KAG既存的指令，文字组合起来，自由地定义新指令的方法。<br />
　KAG 剧本编写中，可能经常会出现有一些指令段，需要在很多地方重复写好几次的情况。假如使用宏的话，就可以大幅度减少这种重复造成的麻烦。<br />
　请随心所欲地将经常会写在一起的指令们变成宏吧。<code class="inlinecode">(^^)</code><br />
</div></div>
<h1><a id="id117" name="id117">基本的使用方法</a>
</h1><div class="para"><div>
　要使用宏，首先要进行宏的「定義」。只要定义一次，之后就可以反复地使用这个宏了。所以，宏的定义，最好是写在first.ks开始的地方。<br />
<br />
　定义宏的办法是，使用<a id="id118" name="id118" class="targanchor"><dfn>macro</dfn></a> 指令和 <a id="id119" name="id119" class="targanchor"><dfn>endmacro</dfn></a> 指令で，将想要设定成宏的段落括起来。macro 指令的属性 name ，就定义了这个宏的名字。（也就是新指令的指令名）<br />
<br />

<br />
<code class="bq">[wait&nbsp;time=200]<br />
*start|开始<br />
[cm]<br />
;&nbsp;--&nbsp;宏的定义&nbsp;--<br />
<em>[macro&nbsp;name=newtag]</em>[font&nbsp;color=0xff0000]这是显示一段文字的宏[resetfont]<em>[endmacro]</em><br />
</code>
<br />

<br />
想要使用的话，就和使用一般的指令一样，把宏的名字写上就可以了。<br />

<br />
<code class="bq">;&nbsp;--&nbsp;宏的使用&nbsp;--<br />
[newtag]<br />
</code>
<br />

<br />
　像上面这样写上 <code class="inlinecode">[newtag]</code> ， <code class="inlinecode">[newtag]</code> 这个指令执行时， 等同于执行了 <code class="inlinecode">[font color=0xff0000]这是显示一段文字的宏[resetfont]</code> ，所以将会显示红色文字：「这是显示一段文字的宏」。<br />
<br />
　宏的定义可以写成多行。（如下例）<br />
<br />

<br />
<code class="bq">[wait&nbsp;time=200]<br />
*start|开始<br />
[cm]<br />
;&nbsp;--&nbsp;宏的定义&nbsp;--<br />
[macro&nbsp;name=newtag]<br />
[font&nbsp;color=0xff0000]<br />
这是显示一段文字的宏<br />
[resetfont]<br />
[endmacro]<br />
</code>
<br />


<br />
<code class="bq">;&nbsp;--&nbsp;宏的使用&nbsp;--<br />
[newtag]<br />
</code>
<br />

</div></div>
<h1><a id="id120" name="id120">宏的属性</a>
</h1><div class="para"><div>
　定义宏的同时，也自己定义了属性的话，就可以使用属性改变执行时的效果了。<br />
　在宏定义中，将属性値以 <a id="id121" name="id121" class="targanchor"><dfn>%</dfn></a> 开头，百分号后面的文字就成为一个自定义的属性名。<br />
　以下の例を見てください。<br />

<br />
<code class="bq">[wait&nbsp;time=200]<br />
*start|开始<br />
[cm]<br />
;&nbsp;--&nbsp;宏的定义&nbsp;--<br />
[macro&nbsp;name=newtag]<br />
[font&nbsp;color=<em>%iro</em>]<br />
这是显示一段文字的宏<br />
[resetfont]<br />
[endmacro]<br />
</code>
<br />


<br />
<code class="bq">;&nbsp;--&nbsp;宏的使用&nbsp;--<br />
[newtag&nbsp;<em>iro=0x00ff00</em>]<br />
</code>
<br />

<br />
　在本例中，就定义了 iro 这个属性，功能等价于 font 的 color 属性。<br />
　执行时，如上例，显示了绿色字的：「这是显示一段文字的宏」。<br />
<br />
<br />
　此外，宏里的指令，假如后面加上 <a id="id122" name="id122" class="targanchor"><dfn>*</dfn></a> 的话，这个指令所带的全部属性，都将成为宏的自定义属性。例如，将 trans 指令和 wt 指令缩写成一个宏，<br />
<br />

<br />
<code class="bq">[macro&nbsp;name=transwait][trans&nbsp;<em>*</em>][wt][endmacro]<br />
</code>
<br />

<br />
　就可以写成这样。在这个例子中，假如使用 transwait 这个宏，就可以通过 transwait 直接指定 trans 指令所拥有的全部属性，对于扩展既有的 KAG 指令是相当方便的功能。<br />
<br />
　宏可以进行嵌套，但是请注意不要在宏的定义里调用自身哦。(^^)<br />
<br />
　如果想要省略属性值，可以为宏指定默认值。% 指定的属性名之后，写上 <a id="id123" name="id123" class="targanchor"><dfn>|</dfn></a> ( 竖线 ) ，之后写上当省略时，会默认指定的值。请看下面的例子。<br />
<br />

<br />
<code class="bq">[wait&nbsp;time=200]<br />
*start|开始<br />
[cm]<br />
;&nbsp;--&nbsp;宏的定义&nbsp;--<br />
[macro&nbsp;name=newtag]<br />
[font&nbsp;color=%color<em>|0xff0000</em>]<br />
这是显示一段文字的宏<br />
[resetfont]<br />
[endmacro]<br />
</code>
<br />


<br />
<code class="bq">;&nbsp;--&nbsp;宏的使用&nbsp;--<br />
[newtag&nbsp;color=0x00ff00]<br />
[newtag]<br />
</code>
<br />

　使用第一个 [newtag] 时，指定了 color 属性的值，因此文字颜色表现为 0x00ff00 ，緑色。<br />
　使用第二个 [newtag] 时，没有指定 color  属性，因此使用了预设的默认值 &quot;0xff0000&quot; ，文字颜色为红色。<br />
<br />
<br /><div class="note"><div class="notehead"><span class="noteheadspan">Note</span></div>
　属性名的指定，请使用半角英文。使用全角、汉字等是不行的。（译注：宏属性必须半角英文，但宏的名字就比较自由，甚至可以使用中文）</div><br />
</div></div>
	<script type="text/javascript" charset="UTF-8" src="documentid.js" ></script>
	<script type="text/javascript" charset="UTF-8" src="postcontent.js" ></script>
</body>
</html>
